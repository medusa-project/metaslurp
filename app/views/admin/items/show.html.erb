<% provide(:title, @item.title) %>

<h1><%= @item.title %></h1>

<nav style="margin-bottom: 1em">
  <div class="nav nav-tabs" id="nav-tab" role="tablist">
    <a class="nav-item nav-link active" id="nav-system-info-tab" data-toggle="tab"
       href="#nav-system-info" role="tab" aria-controls="nav-system-info"
       aria-selected="true">System Information</a>
    <a class="nav-item nav-link" id="nav-descriptive-info-tab" data-toggle="tab"
       href="#nav-descriptive-info" role="tab" aria-controls="nav-descriptive-info"
       aria-selected="false">Descriptive Information</a>
    <a class="nav-item nav-link" id="nav-document-tab" data-toggle="tab"
       href="#nav-document" role="tab" aria-controls="nav-document"
       aria-selected="false">Indexed Document</a>
  </div>
</nav>

<div class="tab-content">
  <div class="tab-pane fade show active" id="nav-system-info" role="tabpanel"
       aria-labelledby="nav-system-info-tab">
    <dl>
      <dt>Content Service</dt>
      <dd>
        <%= link_to admin_content_service_path(@item.content_service) do %>
          <%= icon_for @item.content_service %>
          <%= @item.content_service.name %>
        <% end %>
      </dd>
      <dt>Local ID</dt>
      <dd><code><%= @item.id %></code></dd>
      <dt>Source ID</dt>
      <dd><code><%= @item.source_id %></code></dd>
      <dt>Source URI</dt>
      <dd><%= link_to @item.source_uri, @item.source_uri, target: '_blank' %></dd>
      <dt>Variant</dt>
      <dd><%= @item.variant %></dd>
      <dt>Media Type</dt>
      <dd><%= @item.media_type.present? ? @item.media_type : 'None' %></dd>
      <dt>Last Harvest</dt>
      <dd>
        <%= link_to harvest_title(@item.harvest),
                    admin_harvest_path(@item.harvest) %>
      </dd>
    </dl>
  </div>

  <div class="tab-pane fade" id="nav-descriptive-info" role="tabpanel"
       aria-labelledby="nav-descriptive-info-tab">
    <table class="table">
      <tr>
        <th>Source Element</th>
        <th><%= link_to 'Local Element Mapping',
                        admin_content_service_path(@item.content_service) %></th>
        <th>Value</th>
      </tr>
      <% @item.elements.sort_by{ |e| e.name }.each do |element| %>
        <tr>
          <td>
            <code><%= element.name %></code>
          </td>
          <td>
            <%= @item.content_service.element_def_for_element(element)&.label %>
          </td>
          <td><%= element.value %></td>
        </tr>
      <% end %>
    </table>
  </div>

  <div class="tab-pane fade" id="nav-document" role="tabpanel"
       aria-labelledby="nav-document-tab">
    <div class="alert alert-info">
      <ul>
        <li><code><%= SourceElement::INDEX_PREFIX %>*</code>: source element</li>
        <li><code><%= LocalElement::STRING_INDEX_PREFIX %>*</code>: local element</li>
      </ul>
    </div>
    <pre><%= JSON.pretty_unparse(@indexed_document) %></pre>
  </div>
</div>
