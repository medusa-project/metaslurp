<% provide :title, @user.username %>
<% provide :active_nav, 'access' %>

<ol class="breadcrumb">
  <li><%= link_to 'Home', admin_root_path %></li>
  <li><%= link_to 'Users', admin_users_path %></li>
  <li class="active"><%= @user.username %></li>
</ol>

<div class="btn-group pull-right">
  <div class="btn-group">
    <!-- Actions menu -->
    <% if current_user.admin? or @user == current_user %>
      <button type="button" class="btn btn-default dropdown-toggle"
              data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        Actions <span class="caret"></span>
      </button>
      <ul class="dropdown-menu" role="menu">
        <li>
          <%= link_to admin_user_reset_api_key_path(@user), method: :post do %>
            <i class="fa fa-key"></i> Reset API Key
          <% end %>
        </li>
      </ul>
    <% end %>
  </div>
  <% if current_user.admin? or current_user == @user %>
    <%= link_to edit_admin_user_path(@user), class: 'btn btn-default' do %>
      <i class="fa fa-pencil"></i> Edit
    <% end %>
  <% end %>
  <% if current_user.admin? %>
    <%= link_to admin_user_path(@user), method: :delete,
                class: 'btn btn-danger',
                data: { confirm: 'Are you sure you want to delete this user?' } do %>
      <i class="fa fa-trash"></i> Delete
    <% end %>
  <% end %>
</div>

<h1><%= @user.username %></h1>

<div class="row">

  <div class="col-sm-3">
    <dl>
      <dt>Roles</dt>
      <dd>
        <% if @user.roles.any? %>
          <ul>
            <% @user.roles.each do |role| %>
              <li><%= link_to role.name, admin_role_path(role) %></li>
            <% end %>
          </ul>
        <% else %>
          None
        <% end %>
      </dd>
      <dt>Type</dt>
      <dd><%= @user.human ? 'Human' : 'Non-Human' %></dd>
      <dt>API Key</dt>
      <dd>
        <% if @user == current_user %>
          <% if @user.api_key.present? %>
            <code><%= @user.api_key %></code>
          <% else %>
            None
          <% end %>
        <% else %>
          <% if @user.human %>
            Only visible to <%= @user %>
          <% elsif current_user.admin? %>
            <code><%= @user.api_key %></code>
          <% else %>
            Only visible to <%= @user %> and administrators
          <% end %>
        <% end %>
      </dd>
      <dt>Account Created</dt>
      <dd><%= local_time_ago(@user.created_at) %></dd>
    </dl>
  </div>
</div>
