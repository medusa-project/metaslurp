<% provide :title, 'Elements' %>
<% provide :body_id, 'admin_elements' %>
<% provide :active_nav, 'entities' %>

<ol class="breadcrumb">
  <li><%= link_to 'Home', admin_root_path %></li>
  <li class="active">Elements</li>
</ol>

<% if current_user.admin? %>
  <div class="btn-group pull-right">
    <!-- Add Element button -->
    <button type="button" class="btn btn-default" data-toggle="modal"
            data-target="#dl-add-element-modal">
      <span class="fa fa-plus"></span> Add Element
    </button>
    <!-- Import button -->
    <button type="button" class="btn btn-default" data-toggle="modal"
            data-target="#dl-import-modal">
      <i class="fa fa-upload"></i> Import&hellip;
    </button>
    <!-- Export button -->
    <%= link_to @permitted_params.merge(format: 'json'), type: 'button', class: 'btn btn-default' do %>
      <i class="fa fa-download"></i> Export
    <% end %>
  </div>
<% end %>

<h1>Elements <span class="badge"><%= @elements.count %></span></h1>

<table class="table table-striped">
  <thead>
    <tr>
      <th style="width: 1px"></th>
      <th style="width: 1px"></th>
      <th>Name</th>
      <th>Label</th>
      <th>Description</th>
      <th>Searchable</th>
      <th>Sortable</th>
      <th>Facetable</th>
    </tr>
  </thead>
  <tbody>
    <% @elements.each do |element| %>
      <tr>
        <td>
          <% if current_user.admin? %>
            <button type="button" class="btn btn-default btn-xs dl-edit-element"
                    data-toggle="modal" data-target="#dl-edit-element-modal"
                    data-element-name="<%= element.name %>">
              <i class="fa fa-pencil"></i> Edit
            </button>
          <% end %>
        </td>
        <td>
          <% if current_user.admin? %>
            <%= link_to admin_element_path(element),
                        class: 'btn btn-danger btn-xs', method: :delete,
                        data: { confirm: 'Are you sure you want to delete '\
                        'this element?' } do %>
               <i class="fa fa-trash"></i> Delete
            <% end %>
          <% end %>
        </td>
        <td><code><%= element.name %></code></td>
        <td><%= element.label %></td>
        <td><%= element.description %></td>
        <td class="text-center <%= element.searchable ? 'bg-success' : 'bg-danger' %>">
          <%= boolean(element.searchable) %>
        </td>
        <td class="text-center <%= element.sortable ? 'bg-success' : 'bg-danger' %>">
          <%= boolean(element.sortable) %>
        </td>
        <td class="text-center <%= element.facetable ? 'bg-success' : 'bg-danger' %>">
          <%= boolean(element.facetable) %>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>

<%= render partial: 'add_modal', locals: { element: @new_element,
                                           context: :new } %>
<%= render partial: 'edit_modal' %>
<%= render partial: 'import_modal' %>
