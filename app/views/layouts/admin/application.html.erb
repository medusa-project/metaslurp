<!DOCTYPE html>
<html lang="en">
<head>
  <title><%= yield(:title) %> |
    <%= Option::string(Option::Keys::WEBSITE_NAME) %> Control Panel</title>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <%= csrf_meta_tags %>

  <%= stylesheet_link_tag 'admin', media: 'all' %>
  <%= javascript_include_tag 'admin/application' %>
  <!--[if lt IE 9]>
  <script src="https://raw.githubusercontent.com/aFarkas/html5shiv/master/src/html5shiv.js"></script>
  <![endif]-->

  <%= content_for :head %>
</head>

<body class="dl-admin"
      <%= !yield(:body_id).empty? ? raw("id=\"#{yield(:body_id)}\"") : nil %>
      <%= raw("data-nav=\"#{yield(:active_nav)}\"") %>>

  <nav class="navbar navbar-expand-md navbar-dark bg-dark">
    <%= link_to admin_root_path, class: 'navbar-brand' do %>
      <i class="fa fa-dashboard"></i>
    <% end %>

    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#dl-navbar-collapse" aria-controls="dl-navbar-collapse"
            aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="dl-navbar-collapse">
      <ul class="navbar-nav">
        <li class="nav-item dropdown" id="entities-nav">
          <a class="nav-link dropdown-toggle" id="dl-entities-menu-toggle"
             data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" href="#">
            Entities
          </a>
          <div class="dropdown-menu" aria-labelledby="dl-entities-menu-toggle">
            <%= link_to 'Elements', admin_elements_path, class: 'dropdown-item' %>
            <%= link_to 'Content Services', admin_content_services_path, class: 'dropdown-item' %>
          </div>
        </li>

        <li class="nav-item dropdown" id="access-nav">
          <a class="nav-link dropdown-toggle" id="dl-access-menu-toggle"
             data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" href="#">
            Access
          </a>
          <div class="dropdown-menu" aria-labelledby="dl-access-menu-toggle">
            <%= link_to 'Roles', admin_roles_path, class: 'dropdown-item' %>
            <%= link_to 'Users', admin_users_path, class: 'dropdown-item' %>
          </div>
        </li>

        <% if current_user.admin? %>
          <li class="nav-item dropdown" id="server-nav">
            <a class="nav-link dropdown-toggle" id="dl-server-menu-toggle"
               data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" href="#">
              Server
            </a>
            <div class="dropdown-menu" aria-labelledby="dl-server-menu-toggle">
              <%= link_to 'Configuration', admin_configuration_path, class: 'dropdown-item' %>
            </div>
          </li>
        <% end %>
      </ul>
      <ul class="navbar-nav ml-md-auto">
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" id="dl-user-menu-toggle"
             data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" href="#">
            <i class="fa fa-user" aria-hidden="true"></i>
            <%= current_user.username %>
          </a>
          <div class="dropdown-menu dropdown-menu-right"
               aria-labelledby="dl-user-menu-toggle">
            <%= link_to 'Public Website', root_url, class: 'dropdown-item' %>
            <%= link_to 'HTTP API', api_url, class: 'dropdown-item' %>
            <%= link_to 'Sign Out', signout_path, method: :delete, class: 'dropdown-item' %>
          </div>
        </li>
      </ul>
    </div>
  </nav>

  <div class="container-fluid">
    <%= flashes %>

    <% # It would be better to use the config.force_ssl config option here,
       # but this causes problems with the Elastic Beanstalk health check, which
       # doesn't send an X-Forwarded-Proto header. %>
    <%= hidden_field_tag('dl-root-url', root_url(protocol: Rails.env.production? ? :https : :http)) %>
    <%= hidden_field_tag('dl-root-path', root_path) %>
    <%= hidden_field_tag('dl-current-path', request.fullpath) %>

    <div id="dl-page-content">
      <%= yield.force_encoding(Encoding::UTF_8) %>
    </div>
  </div>

  <footer></footer>

</body>
</html>
